# testing-with-grafana-cloud

Dreaming of using Grafana Cloud for all your testing needs? This repository will help you get started.

> Note: The demo app used for all examples is [QuickPizza](https://quickpizza.grafana.com/).

What you'll find here:
- `src/`
  - `backend/` – k6 tests for backend APIs
  - `web_app/` – k6 tests for frontend
  - `_lib/http_client.ts` – autogenerated using [openapi-to-k6](https://github.com/grafana/openapi-to-k6)
- `specs/`
  - `quickpizza.openapi.yaml` – OpenAPI spec for QuickPizza
- `terraform/`
  - `gck6.projects.tf` – GCk6 projects, limits, and quotas
  - `gck6.permissions.tf` – GCk6 RBAC config
  - `gck6.scheduled_tests.tf` – GCk6 scheduled tests
  - `sm.checks.tf` – Synthetic Monitoring checks (incl. multi-file test example)
  - `stack.teams.tf` – Grafana Cloud stack teams and roles
- `k8s/`
  - `plz.definition.yaml` – GCk6 PLZ test definition
  - `plz.quota.yaml` – GCk6 PLZ quota config
- `.github/workflows/`
  - GitHub Actions using [run-k6-action](https://github.com/grafana/run-k6-action)

## Getting started

To deploy the Terraform resources into your Grafana Cloud stack, you'll need:

- Terraform (>= 1.3.0)
- A Grafana Cloud account with an existing stack

After cloning the repository create a .env file based on the .env.example file.

```bash
cp .env.example .env
```

Then, edit the .env file and add a Grafana Cloud API Key and the details of your stack.
```
STACK_SLUG=mystack
CLOUD_REGION=prod-eu-west-2
CLOUD_ACCESS_POLICY_TOKEN=abdc123
```

That's it! Now run the following command to create the resources in your Grafana Cloud Stack.

```
make tf-bootstrap
```

**Where to find the Stack Slug and Cloud Region?**   
WIP

**What scopes are required for the API Key?** 
stacks:read 
stacks:write 
subscriptions:read 
orgs:read 
stack-service-accounts:write 	
